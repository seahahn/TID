# 20250812

## 1. HTML video element에서 비디오가 끝날 때 onPause와 onEnd 이벤트가 함께 호출되는 경우 대응법

프로젝트 진행중, video 태그에 onPause, onEnd 이벤트를 붙일 일이 있었음.
두 이벤트는 같은 state를 공유하고 있었고, onPause는 state를 초기화하는 역할이었고, onEnd 이벤트에서는 유효한(not null, not undefined) state가 필요한 상황이었음.
그런데 비디오가 끝난 후 의도한대로 동작이 되지 않아 로그를 확인해보니 onPause 이벤트가 onEnd 이벤트 전에 호출이 되고 있었음. 따로 버튼을 누르게 만든 것도 아니고, 명시적으로 onPause를 호출하는 등의 코드는 없었음.

해결 방법을 찾아보니 onPause 이벤트가 호출될 때, 이벤트 내부에서 비디오의 currentTime과 duration을 비교하여 두 값이 같지 않을 때만 onPause 이벤트 내부가 실행이 되도록 하는 방법이 있었음.

```tsx
videoRef.onpause = (e) => {
  if (e.target.currentTime != e.target.duration) {
    // handleOnPause();
  }
}
```

onPause 이벤트 내부에서 로그를 찍어 확인해보니 각각의 값이 나옴과 동시에 비디오의 끝에서는 두 값이 같은 것을 확인할 수 있었음.
하여, 본 방법 적용하여 onPause와 onEnd 이벤트의 작동을 완전히 분리하였음.

<참고 자료>

- [How to distinguish between two "onpause" events - caused by clicking “pause” button, and caused by reaching the end of a media fragment?](https://stackoverflow.com/questions/30297561/how-to-distinguish-between-two-onpause-events-caused-by-clicking-pause-but)