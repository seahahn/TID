# 20220706

1. Next.js E2E Testing using Playwright

- 현재 진행중인 프로젝트의 E2E 테스트를 위한 도구로 Playwright를 사용하기로 함
  - 크롬, 파이어폭스뿐만 아니라 사파리 계열 브라우저에 대한 테스트 가능
  - 모든 브라우저에 대해서 동시에 테스트 진행 가능
  - vscode extension을 비롯해 Action Recording 등의 부가적인 기능을 통해 편리한 사용 가능
- 초기 설정 과정은 아래와 같음

```
// 패키지 설치 및 테스트용 브라우저 설치 -> VS Code extension을 통해서도 설치 가능(참고: https://playwright.dev/docs/intro#using-the-vs-code-extension)
yarn add -D @playwright/test
npx playwright install
```

```ts
// playwright.config.ts
// 참고: https://playwright.dev/docs/test-configuration
import { type PlaywrightTestConfig, devices } from "@playwright/test";

const config: PlaywrightTestConfig = {
  forbidOnly: !!process.env.CI, // boolean. test.only 등 focused test 존재 시 에러 발생 여부. if enabled, the CI throws when there's a focused test (test.only)
  retries: process.env.CI ? 2 : 0, // 테스트 재시도 횟수
  testDir: "tests/e2e", // 테스트 파일 위치
  use: {
    trace: "retain-on-failure", // Record trace for each test, but remove it from successful test runs.
    headless: false, // true: GUI 표시 안 함 | false: GUI 표시
    viewport: { width: 1920, height: 1080 }, // 테스트 시 사용할 화면 크기
    ignoreHTTPSErrors: true, // Whether to ignore HTTPS errors during navigation
    baseURL: "http://localhost:3000", // 테스트 시 사용할 호스트 주소. 이를 사용하면 테스트 코드에서 페이지 이동 시 full URL 입력하지 않아도 됨.
    screenshot: "only-on-failure", // 테스트 실패 시 스크린샷 저장
    video: "on-first-retry", // Record video only when retrying a test for the first time
  },
  // 테스트할 브라우저 종류 설정(참고: https://playwright.dev/docs/api/class-testproject)
  projects: [
    {
      name: "chromium",
      use: devices["Desktop Chrome"],
    },
    {
      name: "firefox",
      use: devices["Desktop Firefox"],
    },
    {
      name: "webkit",
      use: devices["Desktop Safari"],
    },
    {
      name: "Mobile Chrome",
      use: devices["Pixel 5"],
    },
    {
      name: "Mobile Safari",
      use: devices["iPhone 13 Pro"],
    },
  ],
};
export default config;
```

<참고 자료>

- [Getting started - Playwright Docs](https://playwright.dev/docs/intro)
- [Configuration - Playwright Docs](https://playwright.dev/docs/test-configuration)
- [TestOptions - Playwright Docs](https://playwright.dev/docs/api/class-testoptions)
- [TestConfig - Playwright Docs](https://playwright.dev/docs/api/class-testconfig)
- [TestProject - Playwright Docs](https://playwright.dev/docs/api/class-testproject)
- [Writing your first Playwright test](https://timdeschryver.dev/blog/writing-your-first-playwright-test)

---

2. headless browser

- 이름 그대로 머리가 없는 브라우저..라고 하기 보다는 우리가 일반적으로 보는 화면이 보이지 않는 상태의 브라우저라고 보면 됨
- 즉, GUI가 표시되지 않는 브라우저임
- 주로 테스트를 위해서 사용됨
- GUI가 출력되지 않으므로 그만큼 리소스를 덜 먹고, 이 덕분에 테스트 속도가 향상된다는 등의 장점이 있음
- 반면에 화면에 보여지는게 없기 때문에 스냅샷 등의 기록을 남길 수 없다는 등의 단점이 있음

<참고 자료>

- [Headless Browser란?](https://devahea.github.io/2019/04/13/Headless-Browser%EB%9E%80/)
- [헤드리스 브라우저 및 헤드리스 브라우저 테스트 란?](https://ko.myservername.com/what-is-headless-browser)
- [What Is Headless Browser And Headless Browser Testing](https://www.softwaretestinghelp.com/headless-browser-testing/)
